/* GROUP PAGE TREE
=================================================== */
.page-tree {
    .tree-node {
        @apply dark:mb-1;
    }

    .page-tree-branch {
        @apply relative rounded-xl bg-white text-xs shadow;
        @apply dark:bg-dark-600 dark:shadow-lg;
    }

    .tree-node-children {
        @apply dark:mt-1;
    }

    .page-move {
        @apply w-6 dark:border-dark-900 dark:text-dark-175 ltr:rounded-l;
        cursor: grab;
        background-image: url('../../svg/icons/light/drag-dots.svg');
        background-size: 7px 17px;
        background-position: center center;
        background-repeat: no-repeat;

        .dark & {
            background-color: hsla(180, 1%, 18%, 0.5);
        }
    }

    .page-root {
        background-color: hsla(210, 30%, 95%, 0.5);
        @apply flex w-6 items-center dark:border-dark-900 ltr:rounded-l ltr:border-r rtl:rounded-r rtl:border-l;
    }

    /* Nice progressive enhancement to visually connect tree node children by removing the top left border radius.. */
    /* [1] When there are children, except when followed by another tree that has children, or a top level tree */
    .tree-node:not(.nav-builder *):has(.page-tree-branch--has-children):not(:has(+ .tree-node .page-tree-branch--has-children)) + .tree-node .page-tree-branch,
    /* [2] (always) the first level down that has children */
    .tree-node:has(.is-top-level) + .tree-node:not(:has(.is-top-level)) .page-tree-branch {
        border-top-left-radius: 0;
    }
}

/* GROUP PAGE TREE / NAV BUILDER
=================================================== */
/* e.g. cp/nav/edit */
.nav-builder {
    background: none;
    @apply max-w-4xl mx-auto;
    .tree-node {
        @apply pe-1 bg-gray-100;
        &:has(.is-top-level) {
            @apply mt-8 pt-1 px-1! bg-gray-100 rounded-t-2xl;
        }
        &:has(+ .tree-node .is-top-level),
        &:last-child {
            @apply pb-1 rounded-b-2xl;
        }
        /* When we're dragging the tree node, remove the background otherwise it bleeds into the node we're moving it to */
        &.drag-placeholder-wrapper {
            background: none;
        }
        /* When we're dragging the tree node, make sure the preceding node is rounded */
        &:has(+ .drag-placeholder-wrapper) {
            @apply pb-1 rounded-b-2xl;
        }
        /* When we're dragging the tree node, make sure the succeeding node is rounded */
        .drag-placeholder-wrapper + & {
            @apply rounded-t-2xl;
        }
    }
    .page-tree-branch {
        margin-top: 0;
    }
    .tree-node:has(.first-branch) + .tree-node {
        @apply pt-1 rounded-t-2xl;
    }
}