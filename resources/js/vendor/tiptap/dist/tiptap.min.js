
    /*!
    * tiptap v1.13.0
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */


!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("prosemirror-state"),require("prosemirror-view"),require("prosemirror-model"),require("prosemirror-dropcursor"),require("prosemirror-gapcursor"),require("prosemirror-keymap"),require("prosemirror-commands"),require("prosemirror-inputrules"),require("tiptap-utils"),require("vue"),require("tiptap-commands")):"function"==typeof define&&define.amd?define(["exports","prosemirror-state","prosemirror-view","prosemirror-model","prosemirror-dropcursor","prosemirror-gapcursor","prosemirror-keymap","prosemirror-commands","prosemirror-inputrules","tiptap-utils","vue","tiptap-commands"],e):e((t=t||self).tiptap={},t.prosemirrorState,t.prosemirrorView,t.prosemirrorModel,t.prosemirrorDropcursor,t.prosemirrorGapcursor,t.prosemirrorKeymap,t.prosemirrorCommands,t.prosemirrorInputrules,t.tiptapUtils,t.Vue,t.tiptapCommands)}(this,function(t,i,n,r,o,s,u,a,c,h,l,d){"use strict";function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function v(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(t){y(e,t,n[t])})}return e}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function P(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}l=l&&l.hasOwnProperty("default")?l.default:l;var O=function(){function c(t,e){var n=e.extension,i=e.parent,r=e.node,o=e.view,s=e.getPos,u=e.decorations,a=e.editable;f(this,c),this.component=t,this.extension=n,this.parent=i,this.node=r,this.view=o,this.getPos=s,this.decorations=u,this.editable=a,this.selected=!1,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return v(c,[{key:"createDOM",value:function(){var e=this,t=l.extend(this.component);return this.vm=new t({parent:this.parent,propsData:{node:this.node,view:this.view,getPos:this.getPos,decorations:this.decorations,editable:this.editable,selected:!1,options:this.extension.options,updateAttrs:function(t){return e.updateAttrs(t)},updateContent:function(t){return e.updateContent(t)}}}).$mount(),this.vm.$el}},{key:"update",value:function(t,e){return t.type===this.node.type&&(t===this.node&&this.decorations===e||(this.node=t,this.decorations=e,this.updateComponentProps({node:t,decorations:e})),!0)}},{key:"updateComponentProps",value:function(t){var r=this,e=l.config.silent;l.config.silent=!0,Object.entries(t).forEach(function(t){var e=A(t,2),n=e[0],i=e[1];r.vm._props[n]=i}),l.config.silent=e}},{key:"updateAttrs",value:function(t){if(this.editable){var e=this.view.state.tr.setNodeMarkup(this.getPos(),null,k({},this.node.attrs,t));this.view.dispatch(e)}}},{key:"updateContent",value:function(t){if(this.editable){var e=this.view.state.tr.setNodeMarkup(this.getPos(),this.node.type,{content:t});this.view.dispatch(e)}}},{key:"ignoreMutation",value:function(){return!0}},{key:"stopEvent",value:function(t){var e="paste"===t.type;return!!!this.extension.schema.draggable&&!e}},{key:"selectNode",value:function(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function(){this.updateComponentProps({selected:!1})}},{key:"destroy",value:function(){this.vm.$destroy()}}]),c}(),S=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this.options=k({},this.defaultOptions,t)}return v(e,[{key:"inputRules",value:function(){return[]}},{key:"pasteRules",value:function(){return[]}},{key:"keys",value:function(){return{}}},{key:"name",get:function(){return null}},{key:"type",get:function(){return"extension"}},{key:"update",get:function(){return function(){}}},{key:"defaultOptions",get:function(){return{}}},{key:"plugins",get:function(){return[]}}]),e}(),M=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];f(this,e),this.extensions=t}return v(e,[{key:"keymaps",value:function(t){var e=t.schema,n=this.extensions.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.keys}).map(function(t){return t.keys({schema:e})}),i=this.extensions.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.keys}).map(function(t){return t.keys({type:e["".concat(t.type,"s")][t.name],schema:e})});return P(n).concat(P(i)).map(function(t){return u.keymap(t)})}},{key:"inputRules",value:function(t){var e=t.schema,n=this.extensions.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.inputRules}).map(function(t){return t.inputRules({schema:e})}),i=this.extensions.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.inputRules}).map(function(t){return t.inputRules({type:e["".concat(t.type,"s")][t.name],schema:e})});return P(n).concat(P(i)).reduce(function(t,e){return P(t).concat(P(e))},[])}},{key:"pasteRules",value:function(t){var e=t.schema,n=this.extensions.filter(function(t){return["extension"].includes(t.type)}).filter(function(t){return t.pasteRules}).map(function(t){return t.pasteRules({schema:e})}),i=this.extensions.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.pasteRules}).map(function(t){return t.pasteRules({type:e["".concat(t.type,"s")][t.name],schema:e})});return P(n).concat(P(i)).reduce(function(t,e){return P(t).concat(P(e))},[])}},{key:"commands",value:function(t){var s=t.schema,u=t.view,a=t.editable;return this.extensions.filter(function(t){return t.commands}).reduce(function(t,e){var n=e.name,i=e.type,r={},o=e.commands(k({schema:s},["node","mark"].includes(i)?{type:s["".concat(i,"s")][n]}:{}));return Array.isArray(o)?r[n]=function(e){return o.forEach(function(t){return!!a&&(u.focus(),t(e)(u.state,u.dispatch,u))})}:"function"==typeof o?r[n]=function(t){return!!a&&(u.focus(),o(t)(u.state,u.dispatch,u))}:"object"===p(o)&&Object.entries(o).forEach(function(t){var e=A(t,2),n=e[0],i=e[1];Array.isArray(i)?r[n]=function(e){return i.forEach(function(t){return!!a&&(u.focus(),t(e)(u.state,u.dispatch,u))})}:r[n]=function(t){return!!a&&(u.focus(),i(t)(u.state,u.dispatch,u))}}),k({},t,r)},{})}},{key:"nodes",get:function(){return this.extensions.filter(function(t){return"node"===t.type}).reduce(function(t,e){return k({},t,y({},e.name,e.schema))},{})}},{key:"options",get:function(){var o=this.view;return this.extensions.reduce(function(t,r){return k({},t,y({},r.name,new Proxy(r.options,{set:function(t,e,n){var i=t[e]!==n;return Object.assign(t,y({},e,n)),i&&r.update(o),!0}})))},{})}},{key:"marks",get:function(){return this.extensions.filter(function(t){return"mark"===t.type}).reduce(function(t,e){return k({},t,y({},e.name,e.schema))},{})}},{key:"plugins",get:function(){return this.extensions.filter(function(t){return t.plugins}).reduce(function(t,e){var n=e.plugins;return P(t).concat(P(n))},[])}}]),e}(),e=function(t){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return f(this,e),x(this,b(e).call(this,t))}return g(e,S),v(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"mark"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(),E=function(t){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return f(this,e),x(this,b(e).call(this,t))}return g(e,S),v(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"node"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(),j=function(t){function e(){return f(this,e),x(this,b(e).apply(this,arguments))}return g(e,E),v(e,[{key:"name",get:function(){return"doc"}},{key:"schema",get:function(){return{content:"block+"}}}]),e}(),C=function(t){function e(){return f(this,e),x(this,b(e).apply(this,arguments))}return g(e,E),v(e,[{key:"commands",value:function(t){var e=t.type;return function(){return d.setBlockType(e)}}},{key:"name",get:function(){return"paragraph"}},{key:"schema",get:function(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}}}}]),e}(),R=function(t){function e(){return f(this,e),x(this,b(e).apply(this,arguments))}return g(e,E),v(e,[{key:"name",get:function(){return"text"}},{key:"schema",get:function(){return{group:"inline"}}}]),e}(),N=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this.defaultOptions={editorProps:{},editable:!0,autoFocus:!1,extensions:[],content:"",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,dropCursor:{},onInit:function(){},onUpdate:function(){},onFocus:function(){},onBlur:function(){},onPaste:function(){},onDrop:function(){}},this.init(t)}return v(e,[{key:"init",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(k({},this.defaultOptions,e)),this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.state=this.createState(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),this.options.autoFocus&&setTimeout(function(){t.focus()},10),this.options.onInit({view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function(t){this.options=k({},this.options,t),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function(){return new M(P(this.builtInExtensions).concat(P(this.options.extensions)))}},{key:"createPlugins",value:function(){return this.extensions.plugins}},{key:"createKeymaps",value:function(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function(){return this.extensions.inputRules({schema:this.schema})}},{key:"createPasteRules",value:function(){return this.extensions.pasteRules({schema:this.schema})}},{key:"createCommands",value:function(){return this.extensions.commands({schema:this.schema,view:this.view,editable:this.options.editable})}},{key:"createNodes",value:function(){return this.extensions.nodes}},{key:"createMarks",value:function(){return this.extensions.marks}},{key:"createSchema",value:function(){return new r.Schema({nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function(){var t=this;return i.EditorState.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:P(this.plugins).concat([c.inputRules({rules:this.inputRules})],P(this.pasteRules),P(this.keymaps),[u.keymap({Backspace:c.undoInputRule,Escape:a.selectParentNode}),u.keymap(a.baseKeymap),o.dropCursor(this.options.dropCursor),s.gapCursor(),new i.Plugin({key:new i.PluginKey("editable"),props:{editable:function(){return t.options.editable}}}),new i.Plugin({props:{attributes:{tabindex:0}}}),new i.Plugin({props:this.options.editorProps})])})}},{key:"createDocument",value:function(e){if(null===e)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===p(e))try{return this.schema.nodeFromJSON(e)}catch(t){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",t),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"!=typeof e)return!1;var t=document.createElement("div");return t.innerHTML=e.trim(),r.DOMParser.fromSchema(this.schema).parse(t)}},{key:"createView",value:function(){var e=this,t=new n.EditorView(this.element,{state:this.state,handlePaste:this.options.onPaste,handleDrop:this.options.onDrop,dispatchTransaction:this.dispatchTransaction.bind(this)});return t.dom.style.whiteSpace="pre-wrap",t.dom.addEventListener("focus",function(t){return e.options.onFocus({event:t,state:e.state,view:e.view})}),t.dom.addEventListener("blur",function(t){return e.options.onBlur({event:t,state:e.state,view:e.view})}),t}},{key:"setParentComponent",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;t&&this.view.setProps({nodeViews:this.initNodeViews({parent:t,extensions:P(this.builtInExtensions).concat(P(this.options.extensions)),editable:this.options.editable})})}},{key:"initNodeViews",value:function(t){var s=t.parent,e=t.extensions,u=t.editable;return e.filter(function(t){return["node","mark"].includes(t.type)}).filter(function(t){return t.view}).reduce(function(t,o){return k({},t,y({},o.name,function(t,e,n,i){var r=o.view;return new O(r,{extension:o,parent:s,node:t,view:e,getPos:n,decorations:i,editable:u})}))},{})}},{key:"dispatchTransaction",value:function(t){this.state=this.state.apply(t),this.view.updateState(this.state),this.setActiveNodesAndMarks(),t.docChanged&&this.emitUpdate(t)}},{key:"emitUpdate",value:function(t){this.options.onUpdate({getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t})}},{key:"focus",value:function(){this.view.focus()}},{key:"blur",value:function(){this.view.dom.blur()}},{key:"getHTML",value:function(){var t=document.createElement("div"),e=r.DOMSerializer.fromSchema(this.schema).serializeFragment(this.state.doc.content);return t.appendChild(e),t.innerHTML}},{key:"getJSON",value:function(){return this.state.doc.toJSON()}},{key:"setContent",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.state=i.EditorState.create({schema:this.state.schema,doc:this.createDocument(t),plugins:this.state.plugins}),this.view.updateState(this.state),e&&this.emitUpdate()}},{key:"clearContent",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,t)}},{key:"setActiveNodesAndMarks",value:function(){var o=this;this.activeMarks=Object.entries(this.schema.marks).reduce(function(t,e){var n=A(e,2),i=n[0],r=n[1];return k({},t,y({},i,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return h.markIsActive(o.state,r,t)}))},{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce(function(t,e){var n=A(e,2),i=n[0],r=n[1];return k({},t,y({},i,h.getMarkAttrs(o.state,r)))},{}),this.activeNodes=Object.entries(this.schema.nodes).reduce(function(t,e){var n=A(e,2),i=n[0],r=n[1];return k({},t,y({},i,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return h.nodeIsActive(o.state,r,t)}))},{})}},{key:"getMarkAttrs",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[t]}},{key:"registerPlugin",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;t&&(this.state=this.state.reconfigure({plugins:this.state.plugins.concat([t])}),this.view.updateState(this.state))}},{key:"destroy",value:function(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function(){return this.options.useBuiltInExtensions?[new j,new R,new C]:[]}},{key:"isActive",get:function(){return Object.entries(k({},this.activeMarks,this.activeNodes)).reduce(function(t,e){var n=A(e,2),i=n[0],r=n[1];return k({},t,y({},i,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r(t)}))},{})}}]),e}(),T={props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler:function(t){var e=this;t&&t.element&&this.$nextTick(function(){e.$el.appendChild(t.element.firstChild),t.setParentComponent(e)})}}},render:function(t){return t("div")}},D={props:{editor:{default:null,type:Object}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor)}):null}},I=function(){function i(t){var e=t.options,n=t.editorView;f(this,i),this.options=k({},{element:null,onUpdate:function(){return!1}},e),this.editorView=n,this.isActive=!1,this.left=0,this.bottom=0,this.editorView.dom.addEventListener("blur",this.hide.bind(this))}return v(i,[{key:"update",value:function(t,e){var n=t.state;if(!(e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty)this.hide();else{var i=n.selection,r=i.from,o=i.to,s=t.coordsAtPos(r),u=t.coordsAtPos(o),a=this.options.element.offsetParent.getBoundingClientRect(),c=Math.max((s.left+u.left)/2,s.left+3);this.isActive=!0,this.left=parseInt(c-a.left,10),this.bottom=parseInt(a.bottom-s.top,10),this.sendUpdate()}}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,left:this.left,bottom:this.bottom})}},{key:"hide",value:function(t){t&&t.relatedTarget||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.editorView.dom.removeEventListener("blur",this.hide)}}]),i}();var U={props:{editor:{default:null,type:Object}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(t){var n=this;t&&this.$nextTick(function(){var e;t.registerPlugin((e={element:n.$el,onUpdate:function(t){t.isActive&&!1===n.menu.isActive?n.$emit("show",t):t.isActive||!0!==n.menu.isActive||n.$emit("hide",t),n.menu=t}},new i.Plugin({view:function(t){return new I({editorView:t,options:e})}})))})}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),menu:this.menu}):null}},V=function(){function i(t){var e=t.options,n=t.editorView;f(this,i),this.options=k({},{element:null,onUpdate:function(){return!1}},e),this.editorView=n,this.isActive=!1,this.top=0,this.editorView.dom.addEventListener("blur",this.hide.bind(this))}return v(i,[{key:"update",value:function(t,e){var n=t.state;if(!(e&&e.doc.eq(n.doc)&&e.selection.eq(n.selection)))if(n.selection.empty){var i=t.domAtPos(n.selection.$anchor.pos);if("<br>"===i.node.innerHTML&&"P"===i.node.tagName&&i.node.parentNode===t.dom){var r=this.options.element.offsetParent.getBoundingClientRect(),o=t.coordsAtPos(n.selection.$anchor.pos).top-r.top;this.isActive=!0,this.top=o,this.sendUpdate()}else this.hide()}else this.hide()}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,top:this.top})}},{key:"hide",value:function(t){t&&t.relatedTarget||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.editorView.dom.removeEventListener("blur",this.hide)}}]),i}();var $={props:{editor:{default:null,type:Object}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(t){var n=this;t&&this.$nextTick(function(){var e;t.registerPlugin((e={element:n.$el,onUpdate:function(t){n.menu=t}},new i.Plugin({view:function(t){return new V({editorView:t,options:e})}})))})}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),menu:this.menu}):null}};t.Plugin=i.Plugin,t.PluginKey=i.PluginKey,t.TextSelection=i.TextSelection,t.NodeSelection=i.NodeSelection,t.Editor=N,t.Extension=S,t.Node=E,t.Mark=e,t.Doc=j,t.Paragraph=C,t.Text=R,t.EditorContent=T,t.EditorMenuBar=D,t.EditorMenuBubble=U,t.EditorFloatingMenu=$,Object.defineProperty(t,"__esModule",{value:!0})});