<template>
    <set-picker :enabled="enabled" :sets="groups" @added="addSet">
        <template #trigger>
            <div class="flex relative pt-2" :class="{ 'pt-6': showConnector }" v-if="variant === 'button'">
                <div v-if="showConnector" class="absolute group-hover:opacity-0 transition-opacity delay-25 duration-125 inset-y-0 h-full left-3.5 border-l-1 border-gray-400 dark:border-gray-600 border-dashed z-0 dark:bg-dark-700" />
                <Button v-if="enabled" size="sm" :text="label" icon="plus" class="relative z-2" />
            </div>
            <Motion
                v-if="variant === 'between'"
                layout
                class="flex justify-center py-3 relative group"
                :initial="{ paddingTop: '0.75rem', paddingBottom: '0.75rem' }"
                :hover="{ paddingTop: '1.25rem', paddingBottom: '1.25rem' }"
                :transition="{ duration: 0.2 }"
            >
                <div v-if="showConnector" class="absolute group-hover:opacity-0 transition-opacity delay-25 duration-125 inset-y-0 h-full left-3.5 border-l-1 border-gray-400 dark:border-gray-600 border-dashed z-0 dark:bg-dark-700" />
                <button class="w-full absolute inset-0 h-full opacity-0 group-hover:opacity-100 transition-opacity delay-25 duration-75 cursor-pointer">
                    <div class="h-full flex flex-col justify-center">
                        <div class="rounded-full bg-gray-200 h-2" />
                    </div>
                </button>
                <Button v-if="enabled" round icon="plus" size="sm" class="-my-4 z-3 opacity-0 group-hover:opacity-100 transition-opacity delay-25 duration-75" />
            </Motion>
        </template>
    </set-picker>
</template>

<script setup>
import SetPicker from './SetPicker.vue';
import { Button } from '@/components/ui';
import { Motion } from 'motion-v';
import { computed } from 'vue';

const emit = defineEmits(['added']);

const props = defineProps({
    sets: Array,
    groups: Array,
    index: Number,
    enabled: { type: Boolean, default: true },
    label: { type: String },
    showConnector: { type: Boolean, default: true },
    variant: { type: String, default: 'button' },
});

const label = computed(() => props.label ? __(props.label) : __('Add Block'));

function addSet(handle) {
    emit('added', handle, props.index);
}
</script>
